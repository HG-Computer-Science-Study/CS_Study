### 키워드

`대칭 키 암호화 방식`, `공개 키 암호화 방식`, `공개 키 인증서`, `디지털 서명`, `SSL`, `TLS`, `HTTPS`, `TLS 핸드셰이크`

### 시작하기 전에

- 암호화 : 원문 데이터를 알아볼 수 없는 형태로 변경하는 것
- 복호화 : 암호화된 데이터를 원문 데이터로 되돌리는 과정

# 암호와 인증서

## 대칭 키 암호화 방식과 공개 키 암호화 방식

**대칭 키 암호화**

- 암호화와 복호화에 동일한 키를 사용한다
- 키가 유출되면 큰 문제가 발생한다.
- 키를 안전하게 전송하기 어렵지만, 적은 부하 덕분에 암호화 및 복호화를 빠르게 수행할 수 있다.

**공개 키 암호화 (비대칭 키 암호화)**

- 공개 키 : 암호화하는 키
  - 대중에게 공개해도 상관 없음
- 개인 키 : 복호화를 위한 키
  - 유출되면 안됨
- 암호화 및 복호화에 시간과 부하가 많이 들지만 키를 안전하게 공유할 수 있다

**세션 키**

- 대칭 키 암호화 + 공개 키 암호화
- 공개 키로 대칭 키를 암호화하고, 개인 키로 암호화된 대칭 키를 복호화한다.
- 대칭 키를 안전하게 공유함과 동시에, 대칭키를 이용해 빠르게 암호화/복호화를 수행할 수 있다

## 인증서와 디지털 서명

**인증서 (공개키 인증서)**

- 공개 키와 공개 키의 유효성을 입증하기 위한 전자 문서
  - 생성자, 조작 여부, 유효 기간 등의 내용 포함
- 인증서는 **인증 기관(CA)**이라는 제 3의 기관에서 발급
  - ex. IdenTrust, DigiCert, GlobalSign 등
- CA가 발급한 인증서에는 **서명값**이 있다. 클라이언트는 이 서명값을 바탕으로 인증서를 검증할 수 있다

**서명값**

- 서명값을 만드는 방법
  1. **인증서 내용에 대한 해시 값**(지문)을
  2. CA의 개인 키로 암호화하는 방식

**디지털 서명**

- 개인 키로 암호화된 메시지를 공개 키로 복호화함으로써 신원을 증명하는 절차
- 방법
  1. 서명 값과 인증서를 분리한다
  2. 서명 값을 CA의 공개 키로 복호화한다 → 인증서 내용에 대한 해시 값을 얻을 수 있음 - ①
  3. 인증서 데이터에 대한 해시 값을 직접 구한 후 복호화한다 - ②
  4. ①과 ②를 비교한다 → 값이 일치하면 전달받은 인증서의 공개 키를 안심하고 사용할 수 있다.

# HTTPS: SSL과 TLS

- SSL과 TLS는 인증과 암호화를 수행하는 프로토콜이다
  - TLS는 SSL을 계승했다
- HTTPS
  - SSL/TLS를 사용하는 대표적인 프로토콜
  - HTTP 메시지의 안전한 송수신을 위해 개발됨
- HTTPS가 동작하는 방법
  1. TCP 쓰리 웨이 핸드셰이크
  2. **TLS 핸드셰이크**
     - 암호화 통신을 위한 키를 교환한다
     - 인증서 송수신과 검증이 이뤄진다.
  3. 암호화된 메시지 송수신

**TLS 핸드셰이크**

![image (3)](https://github.com/user-attachments/assets/9ce6cbee-d45b-465f-8331-e28178d5ec2d)

1. ClientHello 메시지
   - 암호화된 통신을 위해 서로 맞춰 봐야 할 정보들을 제시함
   - TLS 버전, 사용 가능한 암호화 방식, 해시 함수, 키를 만들기 위해 사용할 클라이언트의 난수 등을 포함
     - **암호 스위트** : 사용 가능한 암호화 방식과 해시 함수를 담은 정보
2. ServerHello 메시지
   - 선택된 TLS 버전, 암호 스위트 등의 정보, 키를 만들기 위해 사용할 서버의 난수 등 포함
   - 이 단계 이후부터 클라이언트와 서버는 키로 암호화된 암호문을 주고받을 수 있다
3. Certificate, CertificateVerify
   - Certificate : 인증서
   - CertificateVerify : 검증을 위한 디지털 서명
   - 클라이언트는 이 메시지를 토대로 서버의 공개 키를 검증한다
4. Finished
   - TLS 핸드셰이크의 마지막을 의미한다
5. 이제 TLS 핸드셰이크를 통해 얻어낸 키를 기반으로 암호화된 데이터를 주고받을 수 있다
