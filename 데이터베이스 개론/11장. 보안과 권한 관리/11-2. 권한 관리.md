# 1. 권한 관리의 개념

- 모든 사용자는 자신에게 발급된 계정으로 로그인해야 데이터베이스에 접근할 수 있다.
- 각 사용자는 자신에게 허용된 권한 내에서만 데이터베이스를 사용할 수 있다. (일부 테이블에만 접근)
- 테이블이나 뷰와 같이 데이터베이스에 존재하는 모든 객체는 기본적으로 해당 객체를 생성한 사용자만 접근권한을 가진다.
- 하지만 **데이터베이스는 여러 사용자가 공유해서 사용할 목적으로 만들어진 것**이므로 필요에 따라 다른 사용자가 만든 객체에도 접근할 수 있어야 한다.
    - SQL 문을 사용해서 다른 사용자에게 자신이 생성한 객체에 대한 적절한 수준의 **사용 권한을 부여하거나 취소**하면 된다!

# 2. 권한의 부여

```sql
 GRANT 권한 ON 객체 TO 사용자 [WITH GRANT OPTION]
```

- 테이블과 관련하여 다른 사용자에게 부여할 수 있는 주요 권한은 `INSERT, DELETE, UPDATE, SELECT, REFERENCES` 가 있는데, 여러 권한을 동시에 부여할 수도 있다.
- `REFERENCES` 의 경우 권한을 부여받은 테이블의 기본키를 참조하는 외래키를 자신이 생성하는 테이블에 포함시킬 수 있다.
- 모든 사용자에게 권한을 부여한다면 `사용자 ⇒ PUBLIC` 을 사용하자.
- `[WITH GRANT OPTION]` 의 경우 다른 사숑자에게 권한을 부여할 수 있는 권한을 준다.

```sql
// PARK 에게 고객 테이블의 등급, 적립금 속성에 대한 수정 권한을 부여
GRANT UPDATE(등급, 적립금) ON 고객 TO PARK;
```

- 보안을 강화하기 위해 뷰를 이용할 수도 있다. 테이블에서 사용자와 관련 있는 부분만 접근하도록 하면 보안을 유지하는데 도움이 된다.
- `CREATE TABLE, CREATE VIEW` 의 경우 데이터베이스 관리자로부터 권한을 부여받아야 한다.

```sql
GRANT CREATE TABLE TO 사용자

GRANT CREATE VIEW TO 사용자
```

# 3. 권한의 취소

```sql
REVOKE 권한 ON 객체 FROM 사용자 CASCADE | RESTRICT;

// HONG 에게 부여한 테이블 생성 (시스템 권한)을 취소한다.
REVOKE CREATE TABLE FROM HONG
```

- `CASCADE`의 경우 해당 사용자가 권한을 부여한 것들도 연쇄적으로 취소한다. `RESTRICT`는 사용자의 권한만 취소한다.

# 4. 역할의 부여와 취소

- 여러 사람들에게 많은 권한을 주려면 `GRANT`문을 너무 많이 작성해야 한다.
- 이때 “역할” 을 미리 만들어서 권한을 담아두면 편하다.
    - 역할을 생성하는 작업은 데이터베이스 관리자만 할 수 있다.
- 역할에 필요한 권한들을 넣을 때는 `GRANT`명령어를 사용한다.
- 역할에 부여된 권한을 수정하고 싶다면 `UPDATE` 을 사용한다.

```sql
// 역할 생성하기
CREATE ROLE 역할이름;

// 역할에 권한 넣기
GRANT SELECT, INSERT, DELETE ON 고객 TO role_1;

// 역할 부여하기
GRANT role_1 TO HONG;

// role_1 에 UPDATE 권한 추가하기
GRANT UPDATE ON 고객 TO role_1;

// 사용자에게 부여한 역할을 취소하기
REVOKE role_1 FROM HONG;

// 역할 삭제하기
DROP ROLE role_1
```